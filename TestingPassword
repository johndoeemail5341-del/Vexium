<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <base target="_top">
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 16px; }
      .row { display: flex; gap: 8px; }
      input[type="password"], input[type="text"] { flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 6px; }
      button { padding: 8px 12px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; }
    </style>
  </head>
  <body>
    <h3>Password</h3>
    <div class="row">
      <input id="pw" type="password" placeholder="Enter password" />
      <button id="go">Submit</button>
    </div>

    <script>
      const $ = (id) => document.getElementById(id);

      function submitPassword() {
        const value = $("pw").value || "";
        google.script.run
          .withSuccessHandler(function(ok) {
            if (ok) {
              // Call server to show a Spreadsheet UI alert
              google.script.run.showCorrectAlert();
            }
            // If wrong: do nothing (per spec)
          })
          .checkPassword(value);
      }

      $("go").addEventListener("click", submitPassword);
      $("pw").addEventListener("keydown", function(e) {
        if (e.key === "Enter") submitPassword();
      });
    </script>
  </body>
</html>

